# Codex Run 4

## Summary
- Added StepTrace-rich desktop runner actions, assertions, extraction, and screenshot handling with error metadata and timeout-aware checks.
- Implemented desktop-only runtime execution with step traces, checkpoint/resume, and run begin/end RPC calls.
- Built a minimal desktop recorder that writes recording.jsonl + screenshots, and documented the v0 recording and runtime execution formats.

## Files Changed
- .github/workflows/ci.yml
- desktop-runner/src/desktop_runner/actions/click.py
- desktop-runner/src/desktop_runner/actions/extract.py
- desktop-runner/src/desktop_runner/actions/paste_text.py
- desktop-runner/src/desktop_runner/actions/set_value.py
- desktop-runner/src/desktop_runner/actions/step_trace.py
- desktop-runner/src/desktop_runner/assertions/check.py
- desktop-runner/src/desktop_runner/server.py
- desktop-runner/tests/test_actions.py
- desktop-runner/tests/test_assertions.py
- desktop-runner/tests/test_extract.py
- desktop-runner/tests/test_screenshots.py
- desktop-runner/tests/test_server.py
- docs/recording_format_v0.md
- docs/runtime_execution.md
- orchestrator/src/cli/args.ts
- orchestrator/src/cli/run.ts
- orchestrator/src/rpc/desktopClient.ts
- orchestrator/src/runtime/artifacts.ts
- orchestrator/src/runtime/checkpoints.ts
- orchestrator/src/runtime/engine.ts
- orchestrator/src/types/workflow.ts
- orchestrator/tests/cli.test.ts
- orchestrator/tests/desktopClient.test.ts
- orchestrator/tests/engine.test.ts
- packages/shared/src/rpc/desktop.rpc.json
- recorder-desktop/pyproject.toml
- recorder-desktop/src/recorder_desktop/__init__.py
- recorder-desktop/src/recorder_desktop/capture/screenshot.py
- recorder-desktop/src/recorder_desktop/record.py
- recorder-desktop/src/recorder_desktop/recording.py
- recorder-desktop/src/recorder_desktop/uia/element_under_cursor.py
- recorder-desktop/src/recorder_desktop/uia/neighborhood.py
- recorder-desktop/src/recorder_desktop/uia/snapshot.py
- recorder-desktop/src/recorder_desktop/win32/hooks.py
- recorder-desktop/src/recorder_desktop/win32/windows.py
- recorder-desktop/tests/test_recording_format.py
- scripts/test.ps1
- steps_to_implement.md

## How to Test Locally (Windows)
- `./scripts/test.ps1`
- `cd orchestrator; npm test`
- `cd desktop-runner; .\.venv\Scripts\python.exe -m pytest -q`
- `cd recorder-desktop; .\.venv\Scripts\python.exe -m pytest -q`

## Manual Verification
- Start a recording: `python -m recorder_desktop.record --name sample --out recordings`
  - Click and type; stop with Enter or F8; inspect `recordings/sample/recording.jsonl` and screenshots.
- Run a desktop-only workflow via the orchestrator `run` command and confirm:
  - `logs/step_traces.jsonl` is populated.
  - `checkpoints.json` updates with `last_success_step_id`.

## Known Issues / Follow-ups
- Recorder event coverage is minimal (no advanced event aggregation or UIA stability heuristics yet).
- Runtime execution currently supports desktop-only actions; web runner is still out of scope for Phase 1.
